# Project-Specific Guidelines: Face Puncher Supreme

This file extends the global Ralph configuration (`~/.claude/CLAUDE.md`).

---

## Selected Policies

Load the following policy modules from `~/.claude/policies/`:

- `languages/go.md`
- `languages/bash.md`
- `languages/python.md`
- `git/standard.md`
- `release-safety/full.md`

---

## Project Overview

- **Type**: Network proxy / investigation prototype
- **Language**: Go (primary), Bash (scripting), Python (tooling)
- **Purpose**: Content-aware HTTPS interception proxy for ad blocking, targeting Apple apps (News, Safari) where DNS-based blocking is ineffective due to same-domain ad serving

---

## Relaxed Rules

No rules relaxed from defaults. All categories kept at strict.

---

## Additional Rules

- **Personal project**: This is a personal project. Never reference company names, internal tools, or business-specific information in code, commits, docs, or generated content.
- **Cross-system testing**: This project uses a macOS agent guide (`agents/macos-agent-guide.md`) to coordinate testing between the Linux dev environment and a macOS/iOS test system. Behavioral claims about Apple apps must be verified via live testing, not assumed from web research.
- **Probe endpoint**: The proxy reserves the `/fps/` URL path prefix for management endpoints. These are never forwarded upstream.
- **Lint gate**: Always run `make lint` (golangci-lint) after editing Go code. Lint must pass before committing, alongside tests and code quality checks. This is part of every validation pass.
- **No Co-Authored-By lines**: Never add `Co-Authored-By` trailers anywhere — not in commit messages, changelogs, READMEs, validation reports, specs, or any other file.
- **Diagrams**: Use Mermaid (`\`\`\`mermaid`) for diagrams in markdown files (specs, docs, READMEs). Do not use custom ASCII art diagrams.

---

## Workflow: Quality Gates

All gates must pass before committing code changes:

1. **Tests**: `make test` (unit tests with `-race -short`)
2. **Lint**: `make lint` (golangci-lint v2, auto-installs if missing)
3. **Vet**: `go vet ./...`
4. **Code quality pass**: Dead code, duplication, encapsulation (per global Phase 4)
5. **Security review**: Per global Phase 5
6. **Validation report**: Written to `validation-reports/`

Do not skip lint. If lint fails after editing code, fix the issues before proceeding.

### Spec Issue Tracking

Specs and validation reports are automatically synced to GitHub Issues via `.github/workflows/spec-tracking.yml`:

- **New spec committed** → GitHub issue created with `[spec-NNN]` title and `spec-tracking` label
- **PASSED validation report committed** → matching spec issue closed automatically
- A PASSED validation report means the spec is done — no separate "mark complete" step needed for issue closure
- Matching logic: filename `spec-NNN` > content `**Specs**: NNN` > topic slug overlap > fallback
- Script logic lives in `scripts/spec-tracking.sh` (not inline YAML)
- Backfill via `workflow_dispatch` trigger in GitHub Actions UI

---

## Environment

- **Go**: Latest stable (1.23+)
- **Build target**: Linux amd64 (proxy server runs on Linux)
- **Test targets**: Linux (local), macOS/iOS (via LAN, coordinated through agent guide)
- **No external Go dependencies for Phase 1** (stdlib only)

---

## Security Extensions

No additional security extensions beyond defaults. Standard OWASP Top 10 and CVE scanning apply.

Note: This project handles network traffic interception. As HTTPS inspection features are added, additional security review requirements may be warranted (certificate handling, private key storage, traffic logging privacy).

---

## Configuration Summary

| Category | Setting | Notes |
|----------|---------|-------|
| Validation Reports | Strict (every commit) | Default |
| Code Quality Checks | Strict (always) | Default |
| Test Requirements | Strict (must pass) | Default |
| Communication Style | Strict (factual) | Default |
| Tool Installation | Strict (always ask) | Default |
| Policies | Go, Bash, Python, git/standard, release-safety/full | |
| Security | Default + future TLS handling review | |

---

*Generated by /ralph-setup on 2026-02-16*
